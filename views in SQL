-- Views in SQL
-- a. Create a view named product_category_sales that provides insights into sales performance by product category. This view should include the following information:
-- productLine: The category name of the product (from the ProductLines table).

-- total_sales: The total revenue generated by products within that category (calculated by summing the orderDetails.quantity * orderDetails.priceEach for each product in the category).

-- number_of_orders: The total number of orders containing products from that category.

-- (Hint: Tables to be used: Products, orders, orderdetails and productlines)

-- The view when read should show the output as:


CREATE VIEW product_category_sales AS
SELECT 
    pl.productLine AS productLine,
    SUM(od.quantityOrdered * od.priceEach) AS total_sales,
    COUNT(DISTINCT o.orderNumber) AS number_of_orders
FROM productLines pl
JOIN products p
    ON pl.productLine = p.productLine
JOIN orderdetails od
    ON p.productCode = od.productCode
JOIN orders o
    ON od.orderNumber = o.orderNumber
GROUP BY pl.productLine;

